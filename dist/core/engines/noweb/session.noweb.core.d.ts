import makeWASocket, { Chat, Contact, SocketConfig, WAMessageContent, WAMessageKey } from '@adiwajshing/baileys';
import { GroupMetadata } from '@adiwajshing/baileys/lib/Types/GroupMetadata';
import { Label as NOWEBLabel } from '@adiwajshing/baileys/lib/Types/Label';
import { ILogger } from '@adiwajshing/baileys/lib/Utils/logger';
import { WhatsappSession } from '@waha/core/abc/session.abc';
import { NOWEBNewsletterMetadata } from '@waha/core/engines/noweb/noweb.newsletter';
import { NowebAuthFactoryCore } from '@waha/core/engines/noweb/NowebAuthFactoryCore';
import { IMediaEngineProcessor } from '@waha/core/media/IMediaEngineProcessor';
import { QR } from '@waha/core/QR';
import { PairingCodeResponse } from '@waha/structures/auth.dto';
import { Channel, ChannelListResult, ChannelMessage, ChannelSearchByText, ChannelSearchByView, CreateChannelRequest, ListChannelsQuery, PreviewChannelMessages } from '@waha/structures/channels.dto';
import { ChatSummary, GetChatMessageQuery, GetChatMessagesFilter, GetChatMessagesQuery, OverviewFilter, PinDuration, ReadChatMessagesQuery, ReadChatMessagesResponse } from '@waha/structures/chats.dto';
import { SendButtonsRequest } from '@waha/structures/chatting.buttons.dto';
import { ChatRequest, CheckNumberStatusQuery, EditMessageRequest, MessageContactVcardRequest, MessageDestination, MessageFileRequest, MessageForwardRequest, MessageImageRequest, MessageLinkCustomPreviewRequest, MessageLinkPreviewRequest, MessageLocationRequest, MessagePollRequest, MessageReactionRequest, MessageReplyRequest, MessageStarRequest, MessageTextRequest, MessageVoiceRequest, SendSeenRequest, WANumberExistResult } from '@waha/structures/chatting.dto';
import { SendListRequest } from '@waha/structures/chatting.list.dto';
import { ContactQuery, ContactRequest, ContactUpdateBody } from '@waha/structures/contacts.dto';
import { WAHAEngine, WAHAPresenceStatus, WAHASessionStatus } from '@waha/structures/enums.dto';
import { BinaryFile, RemoteFile } from '@waha/structures/files.dto';
import { CreateGroupRequest, GroupParticipant, ParticipantsRequest, SettingsSecurityChangeInfo } from '@waha/structures/groups.dto';
import { Label, LabelDTO, LabelID } from '@waha/structures/labels.dto';
import { LidToPhoneNumber } from '@waha/structures/lids.dto';
import { WAMedia } from '@waha/structures/media.dto';
import { ReplyToMessage } from '@waha/structures/message.dto';
import { PaginationParams } from '@waha/structures/pagination.dto';
import { WAHAChatPresences } from '@waha/structures/presence.dto';
import { WAMessage } from '@waha/structures/responses.dto';
import { MeInfo } from '@waha/structures/sessions.dto';
import { DeleteStatusRequest, StatusRequest, TextStatus } from '@waha/structures/status.dto';
import { PollVotePayload, WAMessageAckBody } from '@waha/structures/webhooks.dto';
import { LoggerBuilder } from '@waha/utils/logging';
import * as lodash from 'lodash';
import { INowebStore } from './store/INowebStore';
import { NowebStorageFactoryCore } from './store/NowebStorageFactoryCore';
import { Agents } from '@waha/core/engines/noweb/types';
export declare const BaileysEvents: {
    CONNECTION_UPDATE: string;
    CREDS_UPDATE: string;
    MESSAGES_UPDATE: string;
    MESSAGES_UPSERT: string;
    MESSAGE_RECEIPT_UPDATE: string;
    GROUPS_UPSERT: string;
    PRESENCE_UPDATE: string;
};
export declare class WhatsappSessionNoWebCore extends WhatsappSession {
    private START_ATTEMPT_DELAY_SECONDS;
    private AUTO_RESTART_AFTER_SECONDS;
    engine: WAHAEngine;
    authFactory: NowebAuthFactoryCore;
    storageFactory: NowebStorageFactoryCore;
    private startDelayedJob;
    private shouldRestart;
    private autoRestartJob;
    private msgRetryCounterCache;
    private placeholderResendCache;
    protected engineLogger: ILogger;
    private authNOWEBStore;
    sock: ReturnType<typeof makeWASocket>;
    store: INowebStore;
    private qr;
    private statusTracker;
    constructor(config: any);
    protected set status(value: WAHASessionStatus);
    get status(): WAHASessionStatus;
    start(): Promise<void>;
    unpair(): Promise<void>;
    getSocketConfig(agents: Agents | undefined, state: any): Partial<SocketConfig>;
    makeSocket(): Promise<any>;
    protected makeProxyAgents(): Agents | undefined;
    private ensureStore;
    connectStore(): void;
    resubscribeToKnownPresences(): void;
    buildClient(): Promise<void>;
    private enableAutoRestart;
    protected getMessage(key: WAMessageKey): Promise<WAMessageContent | undefined>;
    protected listenEngineEventsInDebugMode(): void;
    private restartClient;
    protected listenConnectionEvents(): void;
    stop(): Promise<void>;
    protected failed(): Promise<void>;
    private fixMessages;
    private issueMessageUpdateOnEdits;
    private issueMessageUpdateOnPoll;
    private issuePresenceUpdateOnMessageUpsert;
    private end;
    getSessionMeInfo(): MeInfo | null;
    getQR(): QR;
    requestCode(phoneNumber: string, method: string, params?: any): Promise<PairingCodeResponse>;
    getScreenshot(): Promise<Buffer>;
    setProfileName(name: string): Promise<boolean>;
    setProfileStatus(status: string): Promise<boolean>;
    protected setProfilePicture(file: BinaryFile | RemoteFile): Promise<boolean>;
    protected deleteProfilePicture(): Promise<boolean>;
    checkNumberStatus(request: CheckNumberStatusQuery): Promise<WANumberExistResult>;
    generateNewMessageId(): Promise<string>;
    rejectCall(from: string, id: string): Promise<void>;
    sendText(request: MessageTextRequest): Promise<import("@adiwajshing/baileys").WAMessage>;
    deleteMessage(chatId: string, messageId: string): Promise<import("@adiwajshing/baileys").WAMessage>;
    editMessage(chatId: string, messageId: string, request: EditMessageRequest): Promise<import("@adiwajshing/baileys").WAMessage>;
    sendContactVCard(request: MessageContactVcardRequest): Promise<import("@adiwajshing/baileys").WAMessage>;
    sendPoll(request: MessagePollRequest): Promise<WAMessage>;
    reply(request: MessageReplyRequest): Promise<import("@adiwajshing/baileys").WAMessage>;
    sendImage(request: MessageImageRequest): void;
    sendFile(request: MessageFileRequest): void;
    sendVoice(request: MessageVoiceRequest): void;
    sendLinkCustomPreview(request: MessageLinkCustomPreviewRequest): Promise<any>;
    protected uploadMedia(file: RemoteFile | BinaryFile, type: any): Promise<any>;
    sendButtons(request: SendButtonsRequest): Promise<import("@adiwajshing/baileys").WAMessage>;
    sendList(request: SendListRequest): Promise<any>;
    sendLocation(request: MessageLocationRequest): Promise<import("@adiwajshing/baileys").WAMessage>;
    forwardMessage(request: MessageForwardRequest): Promise<WAMessage>;
    sendLinkPreview(request: MessageLinkPreviewRequest): Promise<import("@adiwajshing/baileys").WAMessage>;
    sendSeen(request: SendSeenRequest): Promise<void>;
    startTyping(request: ChatRequest): Promise<void>;
    stopTyping(request: ChatRequest): Promise<void>;
    getChatMessages(chatId: string, query: GetChatMessagesQuery, filter: GetChatMessagesFilter): Promise<any[]>;
    readChatMessages(chatId: string, request: ReadChatMessagesQuery): Promise<ReadChatMessagesResponse>;
    getChatMessage(chatId: string, messageId: string, query: GetChatMessageQuery): Promise<null | WAMessage>;
    pinMessage(chatId: string, messageId: string, duration: PinDuration): Promise<boolean>;
    unpinMessage(chatId: string, messageId: string): Promise<boolean>;
    setReaction(request: MessageReactionRequest): Promise<void | import("@adiwajshing/baileys").WAMessage>;
    setStar(request: MessageStarRequest): Promise<void>;
    getChats(pagination: PaginationParams): Promise<Chat[]>;
    getChatsOverview(pagination: PaginationParams, filter?: OverviewFilter): Promise<ChatSummary[]>;
    protected fetchChatSummary(chat: Chat): Promise<ChatSummary>;
    protected chatsPutArchive(chatId: string, archive: boolean): Promise<any>;
    chatsArchiveChat(chatId: string): Promise<any>;
    chatsUnarchiveChat(chatId: string): Promise<any>;
    chatsUnreadChat(chatId: string): Promise<any>;
    getLabels(): Promise<Label[]>;
    createLabel(label: LabelDTO): Promise<Label>;
    updateLabel(label: Label): Promise<Label>;
    deleteLabel(label: Label): Promise<void>;
    getChatsByLabelId(labelId: string): Promise<Chat[]>;
    getChatLabels(chatId: string): Promise<Label[]>;
    putLabelsToChat(chatId: string, labels: LabelID[]): Promise<void>;
    protected toLabel(label: NOWEBLabel): Label;
    private toLabelChatAssociation;
    upsertContact(chatId: string, body: ContactUpdateBody): Promise<void>;
    getContact(query: ContactQuery): Promise<Contact>;
    getContacts(pagination: PaginationParams): Promise<Contact[]>;
    fetchContactProfilePicture(id: string): Promise<string>;
    blockContact(request: ContactRequest): Promise<void>;
    unblockContact(request: ContactRequest): Promise<void>;
    getAllLids(pagination: PaginationParams): Promise<Array<LidToPhoneNumber>>;
    getLidsCount(): Promise<number>;
    findPNByLid(lid: string): Promise<LidToPhoneNumber>;
    findLIDByPhoneNumber(phoneNumber: string): Promise<LidToPhoneNumber>;
    createGroup(request: CreateGroupRequest): Promise<GroupMetadata>;
    joinGroup(code: string): Promise<string>;
    joinInfoGroup(code: string): Promise<GroupMetadata>;
    getGroups(pagination: PaginationParams): Promise<lodash.Dictionary<GroupMetadata>>;
    protected removeGroupsFieldParticipant(group: any): void;
    refreshGroups(): Promise<boolean>;
    getGroup(id: any): Promise<GroupMetadata>;
    getGroupParticipants(id: string): Promise<GroupParticipant[]>;
    deleteGroup(id: any): Promise<void>;
    getInfoAdminsOnly(id: any): Promise<SettingsSecurityChangeInfo>;
    setInfoAdminsOnly(id: any, value: any): Promise<void>;
    getMessagesAdminsOnly(id: any): Promise<SettingsSecurityChangeInfo>;
    setMessagesAdminsOnly(id: any, value: any): Promise<void>;
    leaveGroup(id: any): Promise<void>;
    setDescription(id: any, description: any): Promise<void>;
    setSubject(id: any, subject: any): Promise<void>;
    getInviteCode(id: any): Promise<string>;
    revokeInviteCode(id: any): Promise<string>;
    getParticipants(id: any): Promise<import("@adiwajshing/baileys").GroupParticipant[]>;
    addParticipants(id: any, request: ParticipantsRequest): Promise<{
        status: string;
        jid: string | undefined;
        content: import("@adiwajshing/baileys").BinaryNode;
    }[]>;
    removeParticipants(id: any, request: ParticipantsRequest): Promise<{
        status: string;
        jid: string | undefined;
        content: import("@adiwajshing/baileys").BinaryNode;
    }[]>;
    promoteParticipantsToAdmin(id: any, request: ParticipantsRequest): Promise<{
        status: string;
        jid: string | undefined;
        content: import("@adiwajshing/baileys").BinaryNode;
    }[]>;
    demoteParticipantsToUser(id: any, request: ParticipantsRequest): Promise<{
        status: string;
        jid: string | undefined;
        content: import("@adiwajshing/baileys").BinaryNode;
    }[]>;
    setPresence(presence: WAHAPresenceStatus, chatId?: string): Promise<void>;
    getPresences(): Promise<WAHAChatPresences[]>;
    getPresence(chatId: string): Promise<WAHAChatPresences>;
    subscribePresence(id: string): Promise<void>;
    sendStatusMessage(message: any, options: any, jids: string[], batchSize?: number): Promise<any>;
    private sendStatusMessageOneChunk;
    sendTextStatus(status: TextStatus): Promise<any>;
    protected prepareMessageIdForStatus(status: StatusRequest): string;
    protected prepareJidsForStatus(contacts: string[]): Promise<string[]>;
    protected fetchMyContactsJids(): Promise<string[]>;
    deleteStatus(request: DeleteStatusRequest): Promise<any>;
    protected upsertMeInJIDs(jids: string[]): void;
    searchChannelsByView(query: ChannelSearchByView): Promise<ChannelListResult>;
    searchChannelsByText(query: ChannelSearchByText): Promise<ChannelListResult>;
    previewChannelMessages(inviteCode: string, query: PreviewChannelMessages): Promise<ChannelMessage[]>;
    protected toChannel(newsletter: NOWEBNewsletterMetadata): Channel;
    channelsList(query: ListChannelsQuery): Promise<Channel[]>;
    channelsCreateChannel(request: CreateChannelRequest): Promise<Channel>;
    channelsGetChannel(id: string): Promise<Channel>;
    channelsGetChannelByInviteCode(inviteCode: string): Promise<Channel>;
    channelsDeleteChannel(id: string): Promise<void>;
    channelsFollowChannel(id: string): Promise<any>;
    channelsUnfollowChannel(id: string): Promise<any>;
    channelsMuteChannel(id: string): Promise<any>;
    channelsUnmuteChannel(id: string): Promise<any>;
    subscribeEngineEvents2(): void;
    protected listenContactsUpdatePictureProfile(): void;
    private processMessageReaction;
    shouldProcessIncomingMessage(message: any): boolean;
    protected processIncomingMessage(message: any, downloadMedia: boolean): Promise<WAMessage | null>;
    protected toWAMessageSafe(message: any): WAMessage | null;
    protected toWAMessage(message: any): WAMessage;
    protected extractReplyTo(message: any): ReplyToMessage | null;
    protected toWAContact(contact: Contact): Contact;
    protected convertMessageUpdateToMessageAck(event: any): WAMessageAckBody;
    protected convertMessageReceiptUpdateToMessageAck(event: any): WAMessageAckBody;
    protected handleMessagesUpdatePollVote(event: any): Promise<PollVotePayload>;
    protected handleMessageUpsertPollVoteFailed(message: any): Promise<PollVotePayload>;
    private toCallData;
    private toWahaPresences;
    protected downloadMediaSafe(message: any): Promise<WAMedia | null>;
    protected downloadMedia(message: any): Promise<WAMedia | null>;
    protected getMessageOptions(request: {
        chatId: string;
        reply_to?: string;
    }): Promise<{
        quoted: any;
        ephemeralExpiration: number;
        messageId: string;
    }>;
    protected getLinkPreview(request: any): any;
    protected generateMessageID(): string;
}
export declare class NOWEBEngineMediaProcessor implements IMediaEngineProcessor<any> {
    session: WhatsappSessionNoWebCore;
    private readonly logger;
    constructor(session: WhatsappSessionNoWebCore, loggerBuilder: LoggerBuilder);
    hasMedia(message: any): boolean;
    getMessageId(message: any): string;
    getChatId(message: any): string;
    getMimetype(message: any): string;
    getMediaBuffer(message: any): Promise<Buffer | null>;
    getFilename(message: any): string | null;
}
export declare const ALL_JID = "all@s.whatsapp.net";
export declare function buildMessageId({ id, remoteJid, fromMe, participant, }: WAMessageKey): string;
export declare function getFromToParticipant(key: any): {
    from: any;
    to: string;
    participant: string;
};
export declare function getDestination(key: any, meId?: any): MessageDestination;
export declare function extractBody(message: any): string | null;
