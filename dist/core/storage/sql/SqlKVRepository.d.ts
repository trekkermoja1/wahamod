import { Field, Schema } from '@waha/core/storage/Schema';
import { IJsonQuery } from '@waha/core/storage/sql/IJsonQuery';
import { PaginationParams } from '@waha/structures/pagination.dto';
import { KnexPaginator } from '@waha/utils/Paginator';
import { Knex } from 'knex';
export type Migration = string;
export declare class SqlKVRepository<Entity> {
    protected knex: Knex;
    protected UPSERT_BATCH_SIZE: number;
    protected Paginator: typeof KnexPaginator;
    protected jsonQuery: IJsonQuery;
    get schema(): Schema;
    get metadata(): Map<string, (entity: Entity) => any>;
    get migrations(): Migration[];
    constructor(knex: Knex);
    get columns(): Field[];
    get table(): string;
    init(): Promise<void>;
    protected applyMigrations(): Promise<void>;
    protected validateSchema(): Promise<void>;
    save(entity: Entity): Promise<void>;
    upsertOne(entity: Entity): Promise<void>;
    upsertMany(entities: Entity[]): Promise<void>;
    protected upsertBatch(entities: Entity[]): Promise<void>;
    getAll(pagination?: PaginationParams): Promise<Entity[]>;
    getCount(): Promise<number>;
    getAllByIds(ids: string[]): Promise<Entity[]>;
    getEntitiesByIds(ids: string[]): Promise<Map<string, Entity | null>>;
    getById(id: string): Promise<Entity | null>;
    getAllBy(filters: any): Promise<Entity[]>;
    getBy(filters: any): Promise<Entity>;
    deleteAll(): Promise<void>;
    deleteById(id: string): Promise<void>;
    deleteBy(filters: any): Promise<void>;
    raw(sql: string, bindings: any[]): Promise<void>;
    protected run(query: Knex.QueryBuilder): Promise<void>;
    protected get(query: Knex.QueryBuilder): Promise<Entity | null>;
    all(query: Knex.QueryBuilder): Promise<Entity[]>;
    select(): Knex.QueryBuilder<{}, ({
        _base: {};
        _hasSelection: boolean;
        _keys: string;
        _aliases: {};
        _single: boolean;
        _intersectProps: {};
        _unionProps: unknown;
    } | {
        _base: {};
        _hasSelection: false;
        _keys: never;
        _aliases: {};
        _single: false;
        _intersectProps: {};
        _unionProps: never;
    })[] | {
        _base: {};
        _hasSelection: false;
        _keys: never;
        _aliases: {};
        _single: false;
        _intersectProps: {};
        _unionProps: never;
    }[]>;
    protected delete(): Knex.QueryBuilder<{}, number>;
    pagination(query: any, pagination?: PaginationParams): any;
    filterJson(field: string, key: string, value: any): [string, string];
    protected stringify(data: any): string;
    protected parse(row: any): any;
    protected dump(entity: Entity): {};
}
