import { BeforeApplicationShutdown, OnApplicationBootstrap } from '@nestjs/common';
import { IAppsService } from '@waha/apps/app_sdk/services/IAppsService';
import { WhatsappConfigService } from '@waha/config.service';
import { EngineBootstrap } from '@waha/core/abc/EngineBootstrap';
import { GowsEngineConfigService } from '@waha/core/config/GowsEngineConfigService';
import { ISessionMeRepository } from '@waha/core/storage/ISessionMeRepository';
import { ISessionWorkerRepository } from '@waha/core/storage/ISessionWorkerRepository';
import { IgnoreJidConfig } from '@waha/core/utils/jids';
import { WAHAWebhook } from '@waha/structures/webhooks.dto';
import { PinoLogger } from 'nestjs-pino';
import { Observable } from 'rxjs';
import { WAHAEngine, WAHAEvents, WAHASessionStatus } from '../../structures/enums.dto';
import { SessionConfig, SessionDetailedInfo, SessionDTO, SessionInfo } from '../../structures/sessions.dto';
import { ISessionAuthRepository } from '../storage/ISessionAuthRepository';
import { ISessionConfigRepository } from '../storage/ISessionConfigRepository';
import { WhatsappSession } from './session.abc';
export declare abstract class SessionManager implements BeforeApplicationShutdown, OnApplicationBootstrap {
    protected log: PinoLogger;
    protected config: WhatsappConfigService;
    protected gowsConfigService: GowsEngineConfigService;
    protected readonly appsService: IAppsService;
    store: any;
    sessionAuthRepository: ISessionAuthRepository;
    sessionConfigRepository: ISessionConfigRepository;
    protected sessionMeRepository: ISessionMeRepository;
    protected sessionWorkerRepository: ISessionWorkerRepository;
    private lock;
    WAIT_SESSION_RUNNING_INTERVAL: number;
    WAIT_SESSION_RUNNING_TIMEOUT: number;
    WAIT_STATUS_INTERVAL: number;
    WAIT_STATUS_TIMEOUT: number;
    protected constructor(log: PinoLogger, config: WhatsappConfigService, gowsConfigService: GowsEngineConfigService, appsService: IAppsService);
    protected startPredefinedSessions(): void;
    withLock(name: string, fn: () => any): any;
    protected abstract getEngine(engine: WAHAEngine): typeof WhatsappSession;
    protected abstract get EngineClass(): typeof WhatsappSession;
    getSessionEvent(session: string, event: WAHAEvents): Observable<any>;
    getSessionEvents(session: string, events: WAHAEvents[]): Observable<any>;
    restart(name: string): any;
    abstract exists(name: string): Promise<boolean>;
    abstract isRunning(name: string): boolean;
    abstract upsert(name: string, config?: SessionConfig): Promise<void>;
    abstract delete(name: string): Promise<void>;
    abstract start(name: string): Promise<SessionDTO>;
    abstract stop(name: string, silent: boolean): Promise<void>;
    abstract logout(name: string): Promise<void>;
    abstract unpair(name: string): Promise<void>;
    abstract getSession(name: string): WhatsappSession;
    abstract getSessionInfo(name: string): Promise<SessionDetailedInfo | null>;
    abstract getSessions(all: boolean): Promise<SessionInfo[]>;
    get workerId(): string;
    assign(name: string): Promise<void>;
    unassign(name: string): Promise<void>;
    getWorkingSession(sessionName: string): Promise<WhatsappSession>;
    waitUntilStatus(sessionName: string, expected: WAHASessionStatus[]): Promise<WhatsappSession>;
    beforeApplicationShutdown(signal?: string): void;
    onApplicationBootstrap(): any;
    protected getEngineBootstrap(engine: WAHAEngine): EngineBootstrap;
    protected ignoreChatsConfig(config: SessionConfig): NonNullable<IgnoreJidConfig & import("../../structures/sessions.dto").IgnoreConfig>;
}
export declare function populateSessionInfo(event: WAHAEvents, session: WhatsappSession): (payload: any) => WAHAWebhook;
